<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  持久化机制 - lengthuo
  
  </title>
 <meta name="description" content="路漫漫其修远兮吾将上下而求索">
 <link href="atom.xml" rel="alternate" title="lengthuo" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html">lengthuo</a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; lengthuo</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>php</label></li>

          
            <li><a title="生成唯一id" href="15196281546423.html">生成唯一id</a></li>
          
            <li><a title="php运行机制" href="15196243924490.html">php运行机制</a></li>
          
            <li><a title="php高级" href="15194406504410.html">php高级</a></li>
          
            <li><a title="魔术方法" href="15194336769696.html">魔术方法</a></li>
          
            <li><a title="php7新特性" href="15173733442452.html">php7新特性</a></li>
          
            <li><a title="supervisor运行laravel的队列" href="15173644197300.html">supervisor运行laravel的队列</a></li>
          
            <li><a title="php数组(只记常用的)" href="15161783412583.html">php数组(只记常用的)</a></li>
          
            <li><a title="输出区别" href="15160839984550.html">输出区别</a></li>
          
            <li><a title="常用内置函数" href="15160723189188.html">常用内置函数</a></li>
          
            <li><a title="强制类型转换" href="15159830999579.html">强制类型转换</a></li>
          
            <li><a title="SPL--SplObjectStorage 方法使用" href="15157440556671.html">SPL--SplObjectStorage 方法使用</a></li>
          
            <li><a title="php 与 nginx" href="15128085452995.html">php 与 nginx</a></li>
          
            <li><a title="练习题" href="15100534066184.html">练习题</a></li>
          
            <li><a title="基础" href="15100478594807.html">基础</a></li>
          
            <li><a title="开发规范" href="15096850612612.html">开发规范</a></li>
          

      
        <li class="divider"></li>
        <li><label>mysql</label></li>

          
            <li><a title="重点：分库分表" href="15193062637949.html">重点：分库分表</a></li>
          
            <li><a title="实战：主键设计" href="15179987835900.html">实战：主键设计</a></li>
          
            <li><a title="日志" href="15178945902959.html">日志</a></li>
          
            <li><a title="mysql存储引擎" href="15178078164903.html">mysql存储引擎</a></li>
          
            <li><a title="重点：mysql数据库开发规范" href="15177931519671.html">重点：mysql数据库开发规范</a></li>
          
            <li><a title="索引-最左原则正确理解" href="15175642572916.html">索引-最左原则正确理解</a></li>
          
            <li><a title="范式" href="15175627851093.html">范式</a></li>
          
            <li><a title="explain执行计划" href="15173182651872.html">explain执行计划</a></li>
          
            <li><a title="B树" href="15172820975706.html">B树</a></li>
          
            <li><a title="索引" href="15172740053891.html">索引</a></li>
          
            <li><a title="重点：开发常用数据库优化方案" href="15172217880874.html">重点：开发常用数据库优化方案</a></li>
          
            <li><a title="手册（笔记）" href="15168781243544.html">手册（笔记）</a></li>
          
            <li><a title="实战：分库分表" href="15167034037540.html">实战：分库分表</a></li>
          
            <li><a title="事务隔离级别" href="15141075416071.html">事务隔离级别</a></li>
          
            <li><a title="undo redo" href="15122837144953.html">undo redo</a></li>
          
            <li><a title="体系结构" href="15122798667483.html">体系结构</a></li>
          

      
        <li class="divider"></li>
        <li><label>设计模式</label></li>

          
            <li><a title="建造者模式 Builder" href="15161735119526.html">建造者模式 Builder</a></li>
          
            <li><a title="模板模式 Template" href="15160863540227.html">模板模式 Template</a></li>
          
            <li><a title="责任链模式 Chain Of Responsibilities" href="15159784361914.html">责任链模式 Chain Of Responsibilities</a></li>
          
            <li><a title="代理模式 Proxy" href="15159191969840.html">代理模式 Proxy</a></li>
          
            <li><a title="迭代器模式 Iterator" href="15159115676241.html">迭代器模式 Iterator</a></li>
          
            <li><a title="装饰者模式 Decorator" href="15157475295856.html">装饰者模式 Decorator</a></li>
          
            <li><a title="观察者模式（发布/订阅）" href="15156567245483.html">观察者模式（发布/订阅）</a></li>
          
            <li><a title="策略者模式 Strategy" href="15156462726597.html">策略者模式 Strategy</a></li>
          
            <li><a title="适配器模式 Adapter" href="15155943331662.html">适配器模式 Adapter</a></li>
          
            <li><a title="注册模式" href="15155930643208.html">注册模式</a></li>
          
            <li><a title="多例模式" href="15155928275964.html">多例模式</a></li>
          
            <li><a title="单例模式 Singleton" href="15155806503913.html">单例模式 Singleton</a></li>
          
            <li><a title="工厂模式 Factory" href="15155788496928.html">工厂模式 Factory</a></li>
          

      
        <li class="divider"></li>
        <li><label>数据结构</label></li>

          
            <li><a title="常用数据结构" href="15179116222861.html">常用数据结构</a></li>
          
            <li><a title="哈夫曼树" href="15105529119460.html">哈夫曼树</a></li>
          
            <li><a title="hashMap" href="15098725685121.html">hashMap</a></li>
          
            <li><a title="树" href="15098688823158.html">树</a></li>
          

      
        <li class="divider"></li>
        <li><label>算法</label></li>

          
            <li><a title="文档--排序-说明" href="15098667005910.html">文档--排序-说明</a></li>
          
            <li><a title="文档--排序-归并排序" href="15098651418800.html">文档--排序-归并排序</a></li>
          
            <li><a title="文档--排序-插入排序-希尔排序（面试热点）" href="15097185400207.html">文档--排序-插入排序-希尔排序（面试热点）</a></li>
          
            <li><a title="文档--排序-选择排序" href="15097183591874.html">文档--排序-选择排序</a></li>
          
            <li><a title="文档--排序-插入排序-直接插入排序（面试热点）" href="15097183328300.html">文档--排序-插入排序-直接插入排序（面试热点）</a></li>
          
            <li><a title="文档--排序-快速排序（面试热点）" href="15097181541647.html">文档--排序-快速排序（面试热点）</a></li>
          
            <li><a title="文档--排序-冒泡(基础)" href="15097179853305.html">文档--排序-冒泡(基础)</a></li>
          

      
        <li class="divider"></li>
        <li><label>linux</label></li>

          
            <li><a title="vim" href="15173837986066.html">vim</a></li>
          
            <li><a title="系统平均负载3个数字的含义" href="15173668021737.html">系统平均负载3个数字的含义</a></li>
          
            <li><a title="Linux下php-fpm进程过多导致内存耗尽问题解决" href="15171886819414.html">Linux下php-fpm进程过多导致内存耗尽问题解决</a></li>
          
            <li><a title="常用命令" href="15157453713814.html">常用命令</a></li>
          
            <li><a title="nginx.conf" href="15121311525125.html">nginx.conf</a></li>
          
            <li><a title="资源使用情况-top" href="15118629061448.html">资源使用情况-top</a></li>
          
            <li><a title="资源使用情况-内存" href="15118570754250.html">资源使用情况-内存</a></li>
          
            <li><a title="资源使用情况-硬盘" href="15118542040577.html">资源使用情况-硬盘</a></li>
          
            <li><a title="系统定时任务-cron" href="15097607422303.html">系统定时任务-cron</a></li>
          
            <li><a title="服务重启" href="15097602933518.html">服务重启</a></li>
          
            <li><a title="系统定时任务-at" href="15097593737810.html">系统定时任务-at</a></li>
          
            <li><a title="文档--linux 查看服务器系统的信息" href="15097189513675.html">文档--linux 查看服务器系统的信息</a></li>
          
            <li><a title="笔记--常用命令" href="15097187372089.html">笔记--常用命令</a></li>
          

      
        <li class="divider"></li>
        <li><label>计算机网络</label></li>

          
            <li><a title="tcp长连接和短连接" href="15126148983598.html">tcp长连接和短连接</a></li>
          
            <li><a title="htpp  tcp  socket RPC 区别" href="15126133687903.html">htpp  tcp  socket RPC 区别</a></li>
          
            <li><a title="cpu信息" href="15121290135332.html">cpu信息</a></li>
          
            <li><a title="加密 - php" href="15120227213651.html">加密 - php</a></li>
          
            <li><a title="笔记" href="15119301111389.html">笔记</a></li>
          

      
        <li class="divider"></li>
        <li><label>git</label></li>

          
            <li><a title="规范-提交代码规范" href="15097964202481.html">规范-提交代码规范</a></li>
          
            <li><a title="文档-git命令大全(图)" href="15097175223406.html">文档-git命令大全(图)</a></li>
          
            <li><a title="笔记-git 常用命令" href="15097169426182.html">笔记-git 常用命令</a></li>
          

      
        <li class="divider"></li>
        <li><label>docker</label></li>

          
            <li><a title="笔记--本地环境" href="15122247911731.html">笔记--本地环境</a></li>
          
            <li><a title="笔记--docker-lnmp" href="15109921864789.html">笔记--docker-lnmp</a></li>
          
            <li><a title="笔记--docker 常用命令" href="15109855218654.html">笔记--docker 常用命令</a></li>
          

      
        <li class="divider"></li>
        <li><label>redis</label></li>

          
            <li><a title="持久化机制" href="15175598361772.html">持久化机制</a></li>
          
            <li><a title="配置" href="15120904003130.html">配置</a></li>
          
            <li><a title="使用小技巧" href="15119287261764.html">使用小技巧</a></li>
          
            <li><a title="支持类型" href="15099434695015.html">支持类型</a></li>
          

      
        <li class="divider"></li>
        <li><label>rabbitMq</label></li>

          
            <li><a title="rabbitMq使用（php）" href="15153208224566.html">rabbitMq使用（php）</a></li>
          
            <li><a title="RPC认识" href="15125232010346.html">RPC认识</a></li>
          

      
        <li class="divider"></li>
        <li><label>java</label></li>

          
            <li><a title="基础-StringBuffer StringBuilder" href="15162420570699.html">基础-StringBuffer StringBuilder</a></li>
          
            <li><a title="基础-常用命令" href="15162420178152.html">基础-常用命令</a></li>
          

      
        <li class="divider"></li>
        <li><label>raml的使用</label></li>

          
            <li><a title="实战--raml命令" href="15151387241047.html">实战--raml命令</a></li>
          

      
        <li class="divider"></li>
        <li><label>负载均衡</label></li>

          
            <li><a title="笔记--负载均衡相关技术" href="15119209173837.html">笔记--负载均衡相关技术</a></li>
          
            <li><a title="笔记--Kubernetes" href="15118321078018.html">笔记--Kubernetes</a></li>
          
            <li><a title="笔记--常用开源软件负载均衡器有：Nginx、LVS、Haproxy。" href="15118307471214.html">笔记--常用开源软件负载均衡器有：Nginx、LVS、Haproxy。</a></li>
          

      
        <li class="divider"></li>
        <li><label>other</label></li>

          
            <li><a title="session 和 token 的区别" href="15197089516431.html">session 和 token 的区别</a></li>
          
            <li><a title="幂等性" href="15197085600692.html">幂等性</a></li>
          
            <li><a title="安全" href="15196955951857.html">安全</a></li>
          
            <li><a title="金融云总结" href="15181672512390.html">金融云总结</a></li>
          
            <li><a title="计算机基础-单位划算" href="15180666486345.html">计算机基础-单位划算</a></li>
          
            <li><a title="计算机基础-寻址空间" href="15180666364633.html">计算机基础-寻址空间</a></li>
          
            <li><a title="进程线程" href="15175609277088.html">进程线程</a></li>
          
            <li><a title="linux" href="15173649652108.html">linux</a></li>
          
            <li><a title="硬盘的读写原理  内存的工作原理及时序介绍" href="15172817075574.html">硬盘的读写原理  内存的工作原理及时序介绍</a></li>
          
            <li><a title="经典问题与解决方案" href="15167863895932.html">经典问题与解决方案</a></li>
          
            <li><a title="专业术语" href="15167559156487.html">专业术语</a></li>
          

      
        <li class="divider"></li>
        <li><label>springboot-初探</label></li>

          
            <li><a title="实战--请求参数的校验" href="15153099746529.html">实战--请求参数的校验</a></li>
          
            <li><a title="实战--参数类的封装（用到的注解）" href="15153060497346.html">实战--参数类的封装（用到的注解）</a></li>
          
            <li><a title="实战--代码读取配置文件" href="15152498896435.html">实战--代码读取配置文件</a></li>
          
            <li><a title="实战--application.yml配置" href="15152489636520.html">实战--application.yml配置</a></li>
          
            <li><a title="实战--aop切面编程" href="15152275531791.html">实战--aop切面编程</a></li>
          
            <li><a title="实战--热部署（热加载）" href="15152265532298.html">实战--热部署（热加载）</a></li>
          
            <li><a title="实战--整合mybatis （分页）" href="15152264815650.html">实战--整合mybatis （分页）</a></li>
          
            <li><a title="实战--日志" href="15152256498572.html">实战--日志</a></li>
          
            <li><a title="实战--统一异常处理" href="15152246712798.html">实战--统一异常处理</a></li>
          
            <li><a title="实战--返回json" href="15152240940735.html">实战--返回json</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>php</span></li>
                        
                          <li><a title="生成唯一id" href="15196281546423.html">生成唯一id</a></li>
                        
                          <li><a title="php运行机制" href="15196243924490.html">php运行机制</a></li>
                        
                          <li><a title="php高级" href="15194406504410.html">php高级</a></li>
                        
                          <li><a title="魔术方法" href="15194336769696.html">魔术方法</a></li>
                        
                          <li><a title="php7新特性" href="15173733442452.html">php7新特性</a></li>
                        
                          <li><a title="supervisor运行laravel的队列" href="15173644197300.html">supervisor运行laravel的队列</a></li>
                        
                          <li><a title="php数组(只记常用的)" href="15161783412583.html">php数组(只记常用的)</a></li>
                        
                          <li><a title="输出区别" href="15160839984550.html">输出区别</a></li>
                        
                          <li><a title="常用内置函数" href="15160723189188.html">常用内置函数</a></li>
                        
                          <li><a title="强制类型转换" href="15159830999579.html">强制类型转换</a></li>
                        
                          <li><a title="SPL--SplObjectStorage 方法使用" href="15157440556671.html">SPL--SplObjectStorage 方法使用</a></li>
                        
                          <li><a title="php 与 nginx" href="15128085452995.html">php 与 nginx</a></li>
                        
                          <li><a title="练习题" href="15100534066184.html">练习题</a></li>
                        
                          <li><a title="基础" href="15100478594807.html">基础</a></li>
                        
                          <li><a title="开发规范" href="15096850612612.html">开发规范</a></li>
                        

                    
                      <li class="side-title"><span>mysql</span></li>
                        
                          <li><a title="重点：分库分表" href="15193062637949.html">重点：分库分表</a></li>
                        
                          <li><a title="实战：主键设计" href="15179987835900.html">实战：主键设计</a></li>
                        
                          <li><a title="日志" href="15178945902959.html">日志</a></li>
                        
                          <li><a title="mysql存储引擎" href="15178078164903.html">mysql存储引擎</a></li>
                        
                          <li><a title="重点：mysql数据库开发规范" href="15177931519671.html">重点：mysql数据库开发规范</a></li>
                        
                          <li><a title="索引-最左原则正确理解" href="15175642572916.html">索引-最左原则正确理解</a></li>
                        
                          <li><a title="范式" href="15175627851093.html">范式</a></li>
                        
                          <li><a title="explain执行计划" href="15173182651872.html">explain执行计划</a></li>
                        
                          <li><a title="B树" href="15172820975706.html">B树</a></li>
                        
                          <li><a title="索引" href="15172740053891.html">索引</a></li>
                        
                          <li><a title="重点：开发常用数据库优化方案" href="15172217880874.html">重点：开发常用数据库优化方案</a></li>
                        
                          <li><a title="手册（笔记）" href="15168781243544.html">手册（笔记）</a></li>
                        
                          <li><a title="实战：分库分表" href="15167034037540.html">实战：分库分表</a></li>
                        
                          <li><a title="事务隔离级别" href="15141075416071.html">事务隔离级别</a></li>
                        
                          <li><a title="undo redo" href="15122837144953.html">undo redo</a></li>
                        
                          <li><a title="体系结构" href="15122798667483.html">体系结构</a></li>
                        

                    
                      <li class="side-title"><span>设计模式</span></li>
                        
                          <li><a title="建造者模式 Builder" href="15161735119526.html">建造者模式 Builder</a></li>
                        
                          <li><a title="模板模式 Template" href="15160863540227.html">模板模式 Template</a></li>
                        
                          <li><a title="责任链模式 Chain Of Responsibilities" href="15159784361914.html">责任链模式 Chain Of Responsibilities</a></li>
                        
                          <li><a title="代理模式 Proxy" href="15159191969840.html">代理模式 Proxy</a></li>
                        
                          <li><a title="迭代器模式 Iterator" href="15159115676241.html">迭代器模式 Iterator</a></li>
                        
                          <li><a title="装饰者模式 Decorator" href="15157475295856.html">装饰者模式 Decorator</a></li>
                        
                          <li><a title="观察者模式（发布/订阅）" href="15156567245483.html">观察者模式（发布/订阅）</a></li>
                        
                          <li><a title="策略者模式 Strategy" href="15156462726597.html">策略者模式 Strategy</a></li>
                        
                          <li><a title="适配器模式 Adapter" href="15155943331662.html">适配器模式 Adapter</a></li>
                        
                          <li><a title="注册模式" href="15155930643208.html">注册模式</a></li>
                        
                          <li><a title="多例模式" href="15155928275964.html">多例模式</a></li>
                        
                          <li><a title="单例模式 Singleton" href="15155806503913.html">单例模式 Singleton</a></li>
                        
                          <li><a title="工厂模式 Factory" href="15155788496928.html">工厂模式 Factory</a></li>
                        

                    
                      <li class="side-title"><span>数据结构</span></li>
                        
                          <li><a title="常用数据结构" href="15179116222861.html">常用数据结构</a></li>
                        
                          <li><a title="哈夫曼树" href="15105529119460.html">哈夫曼树</a></li>
                        
                          <li><a title="hashMap" href="15098725685121.html">hashMap</a></li>
                        
                          <li><a title="树" href="15098688823158.html">树</a></li>
                        

                    
                      <li class="side-title"><span>算法</span></li>
                        
                          <li><a title="文档--排序-说明" href="15098667005910.html">文档--排序-说明</a></li>
                        
                          <li><a title="文档--排序-归并排序" href="15098651418800.html">文档--排序-归并排序</a></li>
                        
                          <li><a title="文档--排序-插入排序-希尔排序（面试热点）" href="15097185400207.html">文档--排序-插入排序-希尔排序（面试热点）</a></li>
                        
                          <li><a title="文档--排序-选择排序" href="15097183591874.html">文档--排序-选择排序</a></li>
                        
                          <li><a title="文档--排序-插入排序-直接插入排序（面试热点）" href="15097183328300.html">文档--排序-插入排序-直接插入排序（面试热点）</a></li>
                        
                          <li><a title="文档--排序-快速排序（面试热点）" href="15097181541647.html">文档--排序-快速排序（面试热点）</a></li>
                        
                          <li><a title="文档--排序-冒泡(基础)" href="15097179853305.html">文档--排序-冒泡(基础)</a></li>
                        

                    
                      <li class="side-title"><span>linux</span></li>
                        
                          <li><a title="vim" href="15173837986066.html">vim</a></li>
                        
                          <li><a title="系统平均负载3个数字的含义" href="15173668021737.html">系统平均负载3个数字的含义</a></li>
                        
                          <li><a title="Linux下php-fpm进程过多导致内存耗尽问题解决" href="15171886819414.html">Linux下php-fpm进程过多导致内存耗尽问题解决</a></li>
                        
                          <li><a title="常用命令" href="15157453713814.html">常用命令</a></li>
                        
                          <li><a title="nginx.conf" href="15121311525125.html">nginx.conf</a></li>
                        
                          <li><a title="资源使用情况-top" href="15118629061448.html">资源使用情况-top</a></li>
                        
                          <li><a title="资源使用情况-内存" href="15118570754250.html">资源使用情况-内存</a></li>
                        
                          <li><a title="资源使用情况-硬盘" href="15118542040577.html">资源使用情况-硬盘</a></li>
                        
                          <li><a title="系统定时任务-cron" href="15097607422303.html">系统定时任务-cron</a></li>
                        
                          <li><a title="服务重启" href="15097602933518.html">服务重启</a></li>
                        
                          <li><a title="系统定时任务-at" href="15097593737810.html">系统定时任务-at</a></li>
                        
                          <li><a title="文档--linux 查看服务器系统的信息" href="15097189513675.html">文档--linux 查看服务器系统的信息</a></li>
                        
                          <li><a title="笔记--常用命令" href="15097187372089.html">笔记--常用命令</a></li>
                        

                    
                      <li class="side-title"><span>计算机网络</span></li>
                        
                          <li><a title="tcp长连接和短连接" href="15126148983598.html">tcp长连接和短连接</a></li>
                        
                          <li><a title="htpp  tcp  socket RPC 区别" href="15126133687903.html">htpp  tcp  socket RPC 区别</a></li>
                        
                          <li><a title="cpu信息" href="15121290135332.html">cpu信息</a></li>
                        
                          <li><a title="加密 - php" href="15120227213651.html">加密 - php</a></li>
                        
                          <li><a title="笔记" href="15119301111389.html">笔记</a></li>
                        

                    
                      <li class="side-title"><span>git</span></li>
                        
                          <li><a title="规范-提交代码规范" href="15097964202481.html">规范-提交代码规范</a></li>
                        
                          <li><a title="文档-git命令大全(图)" href="15097175223406.html">文档-git命令大全(图)</a></li>
                        
                          <li><a title="笔记-git 常用命令" href="15097169426182.html">笔记-git 常用命令</a></li>
                        

                    
                      <li class="side-title"><span>docker</span></li>
                        
                          <li><a title="笔记--本地环境" href="15122247911731.html">笔记--本地环境</a></li>
                        
                          <li><a title="笔记--docker-lnmp" href="15109921864789.html">笔记--docker-lnmp</a></li>
                        
                          <li><a title="笔记--docker 常用命令" href="15109855218654.html">笔记--docker 常用命令</a></li>
                        

                    
                      <li class="side-title"><span>redis</span></li>
                        
                          <li><a title="持久化机制" href="15175598361772.html">持久化机制</a></li>
                        
                          <li><a title="配置" href="15120904003130.html">配置</a></li>
                        
                          <li><a title="使用小技巧" href="15119287261764.html">使用小技巧</a></li>
                        
                          <li><a title="支持类型" href="15099434695015.html">支持类型</a></li>
                        

                    
                      <li class="side-title"><span>rabbitMq</span></li>
                        
                          <li><a title="rabbitMq使用（php）" href="15153208224566.html">rabbitMq使用（php）</a></li>
                        
                          <li><a title="RPC认识" href="15125232010346.html">RPC认识</a></li>
                        

                    
                      <li class="side-title"><span>java</span></li>
                        
                          <li><a title="基础-StringBuffer StringBuilder" href="15162420570699.html">基础-StringBuffer StringBuilder</a></li>
                        
                          <li><a title="基础-常用命令" href="15162420178152.html">基础-常用命令</a></li>
                        

                    
                      <li class="side-title"><span>raml的使用</span></li>
                        
                          <li><a title="实战--raml命令" href="15151387241047.html">实战--raml命令</a></li>
                        

                    
                      <li class="side-title"><span>负载均衡</span></li>
                        
                          <li><a title="笔记--负载均衡相关技术" href="15119209173837.html">笔记--负载均衡相关技术</a></li>
                        
                          <li><a title="笔记--Kubernetes" href="15118321078018.html">笔记--Kubernetes</a></li>
                        
                          <li><a title="笔记--常用开源软件负载均衡器有：Nginx、LVS、Haproxy。" href="15118307471214.html">笔记--常用开源软件负载均衡器有：Nginx、LVS、Haproxy。</a></li>
                        

                    
                      <li class="side-title"><span>other</span></li>
                        
                          <li><a title="session 和 token 的区别" href="15197089516431.html">session 和 token 的区别</a></li>
                        
                          <li><a title="幂等性" href="15197085600692.html">幂等性</a></li>
                        
                          <li><a title="安全" href="15196955951857.html">安全</a></li>
                        
                          <li><a title="金融云总结" href="15181672512390.html">金融云总结</a></li>
                        
                          <li><a title="计算机基础-单位划算" href="15180666486345.html">计算机基础-单位划算</a></li>
                        
                          <li><a title="计算机基础-寻址空间" href="15180666364633.html">计算机基础-寻址空间</a></li>
                        
                          <li><a title="进程线程" href="15175609277088.html">进程线程</a></li>
                        
                          <li><a title="linux" href="15173649652108.html">linux</a></li>
                        
                          <li><a title="硬盘的读写原理  内存的工作原理及时序介绍" href="15172817075574.html">硬盘的读写原理  内存的工作原理及时序介绍</a></li>
                        
                          <li><a title="经典问题与解决方案" href="15167863895932.html">经典问题与解决方案</a></li>
                        
                          <li><a title="专业术语" href="15167559156487.html">专业术语</a></li>
                        

                    
                      <li class="side-title"><span>springboot-初探</span></li>
                        
                          <li><a title="实战--请求参数的校验" href="15153099746529.html">实战--请求参数的校验</a></li>
                        
                          <li><a title="实战--参数类的封装（用到的注解）" href="15153060497346.html">实战--参数类的封装（用到的注解）</a></li>
                        
                          <li><a title="实战--代码读取配置文件" href="15152498896435.html">实战--代码读取配置文件</a></li>
                        
                          <li><a title="实战--application.yml配置" href="15152489636520.html">实战--application.yml配置</a></li>
                        
                          <li><a title="实战--aop切面编程" href="15152275531791.html">实战--aop切面编程</a></li>
                        
                          <li><a title="实战--热部署（热加载）" href="15152265532298.html">实战--热部署（热加载）</a></li>
                        
                          <li><a title="实战--整合mybatis （分页）" href="15152264815650.html">实战--整合mybatis （分页）</a></li>
                        
                          <li><a title="实战--日志" href="15152256498572.html">实战--日志</a></li>
                        
                          <li><a title="实战--统一异常处理" href="15152246712798.html">实战--统一异常处理</a></li>
                        
                          <li><a title="实战--返回json" href="15152240940735.html">实战--返回json</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 <div class="markdown-body">
<h1>持久化机制</h1>

<p>RDB是默认的持久化方式，</p>

<p>RDB 快照：只保留最终的数据，恢复快，只有追中的数据，但是快照会丢失少量数据（毕竟是一个快照版，中间时间间隔会有数据丢失）<br/>
AOF 追加：中间会有多余的操作，数据量大，恢复慢，</p>

<h3 id="toc_0">RDB</h3>

<p>RDB机制的优势和略施<br/>
　<strong>　RDB持久化是指在指定的时间间隔内将内存中的数据集快照写入磁盘。</strong></p>

<p>　　也是默认的持久化方式，这种方式是就是将内存中数据以快照的方式写入到二进制文件中,默认的文件名为dump.rdb。</p>

<p>可以通过配置设置自动做快照持久化的方式。我们可以配置redis在n秒内如果超过m个key被修改就自动做快照，下面是默认的快照保存配置</p>

<p>save 900 1     #900秒内如果超过1个key被修改，则发起快照保存<br/>
   save 300 10    #300秒内容如超过10个key被修改，则发起快照保存<br/>
   save 60 10000<br/>
RDB文件保存过程</p>

<p>redis调用fork,现在有了子进程和父进程。<br/>
父进程继续处理client请求，子进程负责将内存内容写入到临时文件。由于os的写时复制机制（copy on write)父子进程会共享相同的物理页面，当父进程处理写请求时os会为父进程要修改的页面创建副本，而不是写共享的页面。所以子进程的地址空间内的数 据是fork时刻整个数据库的一个快照。<br/>
当子进程将快照写入临时文件完毕后，用临时文件替换原来的快照文件，然后子进程退出。<br/>
client 也可以使用save或者bgsave命令通知redis做一次快照持久化。save操作是在主线程中保存快照的，由于redis是用一个主线程来处理所有 client的请求，这种方式会阻塞所有client请求。所以不推荐使用。</p>

<p>另一点需要注意的是，每次快照持久化都是将内存数据完整写入到磁盘一次，并不 是增量的只同步脏数据。如果数据量大的话，而且写操作比较多，必然会引起大量的磁盘io操作，可能会严重影响性能。</p>

<h4 id="toc_1">优势</h4>

<p>一旦采用该方式，那么你的整个Redis数据库将只包含一个文件，这样非常方便进行备份。比如你可能打算没1天归档一些数据。<br/>
方便备份，我们可以很容易的将一个一个RDB文件移动到其他的存储介质上<br/>
RDB 在恢复大数据集时的速度比 AOF 的恢复速度要快。<br/>
RDB 可以最大化 Redis 的性能：父进程在保存 RDB 文件时唯一要做的就是 fork 出一个子进程，然后这个子进程就会处理接下来的所有保存工作，父进程无须执行任何磁盘 I/O 操作。</p>

<h4 id="toc_2">劣势</h4>

<p>如果你需要尽量避免在服务器故障时丢失数据，那么 RDB 不适合你。 虽然 Redis 允许你设置不同的保存点（save point）来控制保存 RDB 文件的频率， 但是， 因为RDB 文件需要保存整个数据集的状态， 所以它并不是一个轻松的操作。 因此你可能会至少 5 分钟才保存一次 RDB 文件。 在这种情况下， 一旦发生故障停机， 你就可能会丢失好几分钟的数据。<br/>
每次保存 RDB 的时候，Redis 都要 fork() 出一个子进程，并由子进程来进行实际的持久化工作。 在数据集比较庞大时， fork() 可能会非常耗时，造成服务器在某某毫秒内停止处理客户端； 如果数据集非常巨大，并且 CPU 时间非常紧张的话，那么这种停止时间甚至可能会长达整整一秒。 虽然 AOF 重写也需要进行 fork() ，但无论 AOF 重写的执行间隔有多长，数据的耐久性都不会有任何损失。</p>

<h3 id="toc_3">AOF</h3>

<p>AOF文件保存过程<br/>
redis会将每一个收到的写命令都通过write函数追加到文件中(默认是appendonly.aof)。<br/>
当redis重启时会通过重新执行文件中保存的写命令来在内存中重建整个数据库的内容。当然由于os会在内核中缓存 write做的修改，所以可能不是立即写到磁盘上。这样aof方式的持久化也还是有可能会丢失部分修改。不过我们可以通过配置文件告诉redis我们想要 通过fsync函数强制os写入到磁盘的时机。有三种方式如下（默认是：每秒fsync一次）</p>

<p>appendonly yes              //启用aof持久化方式<br/>
 # appendfsync always      //每次收到写命令就立即强制写入磁盘，最慢的，但是保证完全的持久化，不推荐使用<br/>
appendfsync everysec     //每秒钟强制写入磁盘一次，在性能和持久化方面做了很好的折中，推荐<br/>
 # appendfsync no    //完全依赖os，性能最好,持久化没保证<br/>
aof 的方式也同时带来了另一个问题。持久化文件会变的越来越大。例如我们调用incr test命令100次，文件中必须保存全部的100条命令，其实有99条都是多余的。因为要恢复数据库的状态其实文件中保存一条set test 100就够了。</p>

<p>为了压缩aof的持久化文件。redis提供了bgrewriteaof命令。收到此命令redis将使用与快照类似的方式将内存中的数据 以命令的方式保存到临时文件中，最后替换原来的文件。具体过程如下</p>

<p>redis调用fork ，现在有父子两个进程<br/>
子进程根据内存中的数据库快照，往临时文件中写入重建数据库状态的命令<br/>
父进程继续处理client请求，除了把写命令写入到原来的aof文件中。同时把收到的写命令缓存起来。这样就能保证如果子进程重写失败的话并不会出问题。<br/>
当子进程把快照内容写入已命令方式写到临时文件中后，子进程发信号通知父进程。然后父进程把缓存的写命令也写入到临时文件。<br/>
现在父进程可以使用临时文件替换老的aof文件，并重命名，后面收到的写命令也开始往新的aof文件中追加。<br/>
需要注意到是重写aof文件的操作，并没有读取旧的aof文件，而是将整个内存中的数据库内容用命令的方式重写了一个新的aof文件,这点和快照有点类似。</p>

<h4 id="toc_4">优势</h4>

<p>使用 AOF 持久化会让 Redis 变得非常耐久（much more durable）：你可以设置不同的 fsync 策略，比如无 fsync ，每秒钟一次 fsync ，或者每次执行写入命令时 fsync 。 AOF 的默认策略为每秒钟 fsync 一次，在这种配置下，Redis 仍然可以保持良好的性能，并且就算发生故障停机，也最多只会丢失一秒钟的数据（ fsync 会在后台线程执行，所以主线程可以继续努力地处理命令请求）。</p>

<p>AOF 文件是一个只进行追加操作的日志文件（append only log）， 因此对 AOF 文件的写入不需要进行 seek ， 即使日志因为某些原因而包含了未写入完整的命令（比如写入时磁盘已满，写入中途停机，等等）， redis-check-aof 工具也可以轻易地修复这种问题。<br/>
Redis 可以在 AOF 文件体积变得过大时，自动地在后台对 AOF 进行重写： 重写后的新 AOF 文件包含了恢复当前数据集所需的最小命令集合。 整个重写操作是绝对安全的，因为 Redis 在创建新 AOF 文件的过程中，会继续将命令追加到现有的 AOF 文件里面，即使重写过程中发生停机，现有的 AOF 文件也不会丢失。 而一旦新 AOF 文件创建完毕，Redis 就会从旧 AOF 文件切换到新 AOF 文件，并开始对新 AOF 文件进行追加操作。</p>

<p>AOF 文件有序地保存了对数据库执行的所有写入操作， 这些写入操作以 Redis 协议的格式保存， 因此 AOF 文件的内容非常容易被人读懂， 对文件进行分析（parse）也很轻松。 导出（export） AOF 文件也非常简单： 举个例子， 如果你不小心执行了 FLUSHALL 命令， 但只要 AOF 文件未被重写， 那么只要停止服务器， 移除 AOF 文件末尾的 FLUSHALL 命令， 并重启 Redis ， 就可以将数据集恢复到 FLUSHALL 执行之前的状态。</p>

<h4 id="toc_5">劣势</h4>

<p>对于相同的数据集来说，AOF 文件的体积通常要大于 RDB 文件的体积。</p>

<p>根据所使用的 fsync 策略，AOF 的速度可能会慢于 RDB 。 在一般情况下， 每秒 fsync 的性能依然非常高， 而关闭 fsync 可以让 AOF 的速度和 RDB 一样快， 即使在高负荷之下也是如此。 不过在处理巨大的写入载入时，RDB 可以提供更有保证的最大延迟时间（latency）。</p>

<p>AOF 在过去曾经发生过这样的 bug ： 因为个别命令的原因，导致 AOF 文件在重新载入时，无法将数据集恢复成保存时的原样。 （举个例子，阻塞命令 BRPOPLPUSH 就曾经引起过这样的 bug 。） 测试套件里为这种情况添加了测试： 它们会自动生成随机的、复杂的数据集， 并通过重新载入这些数据来确保一切正常。 虽然这种 bug 在 AOF 文件中并不常见， 但是对比来说， RDB 几乎是不可能出现这种 bug 的。</p>


</div>

<br /><br />
<hr />

<div class="row clearfix">
  <div class="large-6 columns">
	<div class="text-left" style="padding:15px 0px;">
		
	        <a href="15099434695015.html"  title="Previous Post: 支持类型">&laquo; 支持类型</a>
	    
	</div>
  </div>
  <div class="large-6 columns">
	<div class="text-right" style="padding:15px 0px;">
		
	        <a href="15168781243544.html" 
	        title="Next Post: 手册（笔记）">手册（笔记） &raquo;</a>
	    
	</div>
  </div>
</div>

<div class="row">
<div style="padding:0px 0.93em;" class="share-comments">

</div>
</div>
<script type="text/javascript">
	$(function(){
		var currentURL = '15175598361772.html';
		$('#side-nav a').each(function(){
			if($(this).attr('href') == currentURL){
				$(this).parent().addClass('active');
			}
		});
	});
</script>  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    <script src="asset/chart/all-min.js"></script><script type="text/javascript">$(function(){    var mwebii=0;    var mwebChartEleId = 'mweb-chart-ele-';    $('pre>code').each(function(){        mwebii++;        var eleiid = mwebChartEleId+mwebii;        if($(this).hasClass('language-sequence')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = Diagram.parse($(this).text());            diagram.drawSVG(eleiid,{theme: 'simple'});        }else if($(this).hasClass('language-flow')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = flowchart.parse($(this).text());            diagram.drawSVG(eleiid);        }    });});</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

  </body>
</html>
