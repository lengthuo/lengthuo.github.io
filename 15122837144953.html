<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  undo（撤销） redo（重做） - lengthuo
  
  </title>
 <meta name="description" content="路漫漫其修远兮吾将上下而求索">
 <link href="atom.xml" rel="alternate" title="lengthuo" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html">lengthuo</a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; lengthuo</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>other</label></li>

          
            <li><a title="经典问题与解决方案" href="15167863895932.html">经典问题与解决方案</a></li>
          
            <li><a title="专业术语" href="15167559156487.html">专业术语</a></li>
          

      
        <li class="divider"></li>
        <li><label>设计模式</label></li>

          
            <li><a title="建造者模式 Builder" href="15161735119526.html">建造者模式 Builder</a></li>
          
            <li><a title="模板模式 Template" href="15160863540227.html">模板模式 Template</a></li>
          
            <li><a title="责任链模式 Chain Of Responsibilities" href="15159784361914.html">责任链模式 Chain Of Responsibilities</a></li>
          
            <li><a title="代理模式 Proxy" href="15159191969840.html">代理模式 Proxy</a></li>
          
            <li><a title="迭代器模式 Iterator" href="15159115676241.html">迭代器模式 Iterator</a></li>
          
            <li><a title="装饰者模式 Decorator" href="15157475295856.html">装饰者模式 Decorator</a></li>
          
            <li><a title="观察者模式（发布/订阅）" href="15156567245483.html">观察者模式（发布/订阅）</a></li>
          
            <li><a title="策略者模式 Strategy" href="15156462726597.html">策略者模式 Strategy</a></li>
          
            <li><a title="适配器模式 Adapter" href="15155943331662.html">适配器模式 Adapter</a></li>
          
            <li><a title="注册模式" href="15155930643208.html">注册模式</a></li>
          
            <li><a title="多例模式" href="15155928275964.html">多例模式</a></li>
          
            <li><a title="单例模式 Singleton" href="15155806503913.html">单例模式 Singleton</a></li>
          
            <li><a title="工厂模式 Factory" href="15155788496928.html">工厂模式 Factory</a></li>
          

      
        <li class="divider"></li>
        <li><label>php</label></li>

          
            <li><a title="php--数组" href="15161783412583.html">php--数组</a></li>
          
            <li><a title="实战--输出" href="15160839984550.html">实战--输出</a></li>
          
            <li><a title="实战--常用内置函数" href="15160723189188.html">实战--常用内置函数</a></li>
          
            <li><a title="实战--强制类型转换" href="15159830999579.html">实战--强制类型转换</a></li>
          
            <li><a title="实战--数组的常用操作" href="15159199909308.html">实战--数组的常用操作</a></li>
          
            <li><a title="SPL--SplObjectStorage 方法使用" href="15157440556671.html">SPL--SplObjectStorage 方法使用</a></li>
          
            <li><a title="文档--配置文件" href="15138234730339.html">文档--配置文件</a></li>
          
            <li><a title="文档--php 与 nginx" href="15128085452995.html">文档--php 与 nginx</a></li>
          
            <li><a title="文档--php7类型声明" href="15106716576449.html">文档--php7类型声明</a></li>
          
            <li><a title="文档--php7-use批量声明" href="15106714388264.html">文档--php7-use批量声明</a></li>
          
            <li><a title="实战--php7-新操作符<=>" href="15106713271560.html">实战--php7-新操作符<=></a></li>
          
            <li><a title="实战--php7-??" href="15106708822268.html">实战--php7-??</a></li>
          
            <li><a title="规范--php7-统一变量语法" href="15106705768192.html">规范--php7-统一变量语法</a></li>
          
            <li><a title="文档--php7-throwable" href="15106686521637.html">文档--php7-throwable</a></li>
          
            <li><a title="实战--练习题" href="15100534066184.html">实战--练习题</a></li>
          
            <li><a title="文档--基础" href="15100478594807.html">文档--基础</a></li>
          
            <li><a title="规范--开发" href="15096850612612.html">规范--开发</a></li>
          

      
        <li class="divider"></li>
        <li><label>rabbitMq</label></li>

          
            <li><a title="rabbitMq使用（php）" href="15153208224566.html">rabbitMq使用（php）</a></li>
          
            <li><a title="RPC认识" href="15125232010346.html">RPC认识</a></li>
          

      
        <li class="divider"></li>
        <li><label>raml的使用</label></li>

          
            <li><a title="实战--raml命令" href="15151387241047.html">实战--raml命令</a></li>
          

      
        <li class="divider"></li>
        <li><label>linux</label></li>

          
            <li><a title="Linux下php-fpm进程过多导致内存耗尽问题解决" href="15171886819414.html">Linux下php-fpm进程过多导致内存耗尽问题解决</a></li>
          
            <li><a title="文档--常用命令" href="15157453713814.html">文档--常用命令</a></li>
          
            <li><a title="文档--nginx.conf" href="15121311525125.html">文档--nginx.conf</a></li>
          
            <li><a title="文档--资源使用情况-top" href="15118629061448.html">文档--资源使用情况-top</a></li>
          
            <li><a title="文档--资源使用情况-内存" href="15118570754250.html">文档--资源使用情况-内存</a></li>
          
            <li><a title="文档--资源使用情况-硬盘" href="15118542040577.html">文档--资源使用情况-硬盘</a></li>
          
            <li><a title="文档--系统定时任务-cron" href="15097607422303.html">文档--系统定时任务-cron</a></li>
          
            <li><a title="文档--服务重启" href="15097602933518.html">文档--服务重启</a></li>
          
            <li><a title="文档--系统定时任务-at" href="15097593737810.html">文档--系统定时任务-at</a></li>
          
            <li><a title="文档--linux 查看服务器系统的信息" href="15097189513675.html">文档--linux 查看服务器系统的信息</a></li>
          
            <li><a title="笔记--常用命令" href="15097187372089.html">笔记--常用命令</a></li>
          

      
        <li class="divider"></li>
        <li><label>git</label></li>

          
            <li><a title="规范-提交代码规范" href="15097964202481.html">规范-提交代码规范</a></li>
          
            <li><a title="文档-git命令大全(图)" href="15097175223406.html">文档-git命令大全(图)</a></li>
          
            <li><a title="笔记-git 常用命令" href="15097169426182.html">笔记-git 常用命令</a></li>
          

      
        <li class="divider"></li>
        <li><label>算法</label></li>

          
            <li><a title="文档--排序-说明" href="15098667005910.html">文档--排序-说明</a></li>
          
            <li><a title="文档--排序-归并排序" href="15098651418800.html">文档--排序-归并排序</a></li>
          
            <li><a title="文档--排序-插入排序-希尔排序（面试热点）" href="15097185400207.html">文档--排序-插入排序-希尔排序（面试热点）</a></li>
          
            <li><a title="文档--排序-选择排序" href="15097183591874.html">文档--排序-选择排序</a></li>
          
            <li><a title="文档--排序-插入排序-直接插入排序（面试热点）" href="15097183328300.html">文档--排序-插入排序-直接插入排序（面试热点）</a></li>
          
            <li><a title="文档--排序-快速排序（面试热点）" href="15097181541647.html">文档--排序-快速排序（面试热点）</a></li>
          
            <li><a title="文档--排序-冒泡(基础)" href="15097179853305.html">文档--排序-冒泡(基础)</a></li>
          

      
        <li class="divider"></li>
        <li><label>数据结构</label></li>

          
            <li><a title="笔记--数据结构" href="15106207591946.html">笔记--数据结构</a></li>
          
            <li><a title="笔记--树-AVL" href="15105532782166.html">笔记--树-AVL</a></li>
          
            <li><a title="笔记--树-哈夫曼树" href="15105529119460.html">笔记--树-哈夫曼树</a></li>
          
            <li><a title="笔记--树-红黑树（Red Black Tree）" href="15102209229230.html">笔记--树-红黑树（Red Black Tree）</a></li>
          
            <li><a title="笔记--树-二叉查找树（BST）" href="15102205459934.html">笔记--树-二叉查找树（BST）</a></li>
          
            <li><a title="笔记--hash" href="15098725685121.html">笔记--hash</a></li>
          
            <li><a title="笔记--树" href="15098688823158.html">笔记--树</a></li>
          

      
        <li class="divider"></li>
        <li><label>vagrant</label></li>

          
            <li><a title="笔记--vagrant 入门" href="15107599286648.html">笔记--vagrant 入门</a></li>
          

      
        <li class="divider"></li>
        <li><label>java</label></li>

          
            <li><a title="基础-StringBuffer StringBuilder" href="15162420570699.html">基础-StringBuffer StringBuilder</a></li>
          
            <li><a title="基础-常用命令" href="15162420178152.html">基础-常用命令</a></li>
          

      
        <li class="divider"></li>
        <li><label>springboot-实战</label></li>

          
            <li><a title="实战--请求参数的校验" href="15153099746529.html">实战--请求参数的校验</a></li>
          
            <li><a title="实战--参数类的封装（用到的注解）" href="15153060497346.html">实战--参数类的封装（用到的注解）</a></li>
          
            <li><a title="实战--代码读取配置文件" href="15152498896435.html">实战--代码读取配置文件</a></li>
          
            <li><a title="实战--application.yml配置" href="15152489636520.html">实战--application.yml配置</a></li>
          
            <li><a title="实战--aop切面编程" href="15152275531791.html">实战--aop切面编程</a></li>
          
            <li><a title="实战--热部署（热加载）" href="15152265532298.html">实战--热部署（热加载）</a></li>
          
            <li><a title="实战--整合mybatis （分页）" href="15152264815650.html">实战--整合mybatis （分页）</a></li>
          
            <li><a title="实战--日志" href="15152256498572.html">实战--日志</a></li>
          
            <li><a title="实战--统一异常处理" href="15152246712798.html">实战--统一异常处理</a></li>
          
            <li><a title="实战--返回json" href="15152240940735.html">实战--返回json</a></li>
          

      
        <li class="divider"></li>
        <li><label>mysql</label></li>

          
            <li><a title="收藏地址" href="15169610880093.html">收藏地址</a></li>
          
            <li><a title="3中锁表方式" href="15169451004852.html">3中锁表方式</a></li>
          
            <li><a title="死锁问题" href="15168789059247.html">死锁问题</a></li>
          
            <li><a title="手册（笔记）" href="15168781243544.html">手册（笔记）</a></li>
          
            <li><a title="分库分表 优缺点 使用场景" href="15167034037540.html">分库分表 优缺点 使用场景</a></li>
          
            <li><a title="事务隔离级别详解" href="15141075416071.html">事务隔离级别详解</a></li>
          
            <li><a title="musql 文件类型" href="15122943074840.html">musql 文件类型</a></li>
          
            <li><a title="聚簇索引和非聚簇索引" href="15122861132096.html">聚簇索引和非聚簇索引</a></li>
          
            <li><a title="undo（撤销） redo（重做）" href="15122837144953.html">undo（撤销） redo（重做）</a></li>
          
            <li><a title="体系结构" href="15122798667483.html">体系结构</a></li>
          

      
        <li class="divider"></li>
        <li><label>docker</label></li>

          
            <li><a title="笔记--本地环境" href="15122247911731.html">笔记--本地环境</a></li>
          
            <li><a title="笔记--docker-lnmp" href="15109921864789.html">笔记--docker-lnmp</a></li>
          
            <li><a title="笔记--docker 常用命令" href="15109855218654.html">笔记--docker 常用命令</a></li>
          

      
        <li class="divider"></li>
        <li><label>redis</label></li>

          
            <li><a title="笔记--配置" href="15120904003130.html">笔记--配置</a></li>
          
            <li><a title="使用经验" href="15119287261764.html">使用经验</a></li>
          
            <li><a title="笔记--支持类型" href="15099434695015.html">笔记--支持类型</a></li>
          

      
        <li class="divider"></li>
        <li><label>负载均衡</label></li>

          
            <li><a title="笔记--负载均衡相关技术" href="15119209173837.html">笔记--负载均衡相关技术</a></li>
          
            <li><a title="笔记--Kubernetes" href="15118321078018.html">笔记--Kubernetes</a></li>
          
            <li><a title="笔记--常用开源软件负载均衡器有：Nginx、LVS、Haproxy。" href="15118307471214.html">笔记--常用开源软件负载均衡器有：Nginx、LVS、Haproxy。</a></li>
          

      
        <li class="divider"></li>
        <li><label>敏捷开发</label></li>

          
            <li><a title="敏捷开发流程" href="15162577596576.html">敏捷开发流程</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>other</span></li>
                        
                          <li><a title="经典问题与解决方案" href="15167863895932.html">经典问题与解决方案</a></li>
                        
                          <li><a title="专业术语" href="15167559156487.html">专业术语</a></li>
                        

                    
                      <li class="side-title"><span>设计模式</span></li>
                        
                          <li><a title="建造者模式 Builder" href="15161735119526.html">建造者模式 Builder</a></li>
                        
                          <li><a title="模板模式 Template" href="15160863540227.html">模板模式 Template</a></li>
                        
                          <li><a title="责任链模式 Chain Of Responsibilities" href="15159784361914.html">责任链模式 Chain Of Responsibilities</a></li>
                        
                          <li><a title="代理模式 Proxy" href="15159191969840.html">代理模式 Proxy</a></li>
                        
                          <li><a title="迭代器模式 Iterator" href="15159115676241.html">迭代器模式 Iterator</a></li>
                        
                          <li><a title="装饰者模式 Decorator" href="15157475295856.html">装饰者模式 Decorator</a></li>
                        
                          <li><a title="观察者模式（发布/订阅）" href="15156567245483.html">观察者模式（发布/订阅）</a></li>
                        
                          <li><a title="策略者模式 Strategy" href="15156462726597.html">策略者模式 Strategy</a></li>
                        
                          <li><a title="适配器模式 Adapter" href="15155943331662.html">适配器模式 Adapter</a></li>
                        
                          <li><a title="注册模式" href="15155930643208.html">注册模式</a></li>
                        
                          <li><a title="多例模式" href="15155928275964.html">多例模式</a></li>
                        
                          <li><a title="单例模式 Singleton" href="15155806503913.html">单例模式 Singleton</a></li>
                        
                          <li><a title="工厂模式 Factory" href="15155788496928.html">工厂模式 Factory</a></li>
                        

                    
                      <li class="side-title"><span>php</span></li>
                        
                          <li><a title="php--数组" href="15161783412583.html">php--数组</a></li>
                        
                          <li><a title="实战--输出" href="15160839984550.html">实战--输出</a></li>
                        
                          <li><a title="实战--常用内置函数" href="15160723189188.html">实战--常用内置函数</a></li>
                        
                          <li><a title="实战--强制类型转换" href="15159830999579.html">实战--强制类型转换</a></li>
                        
                          <li><a title="实战--数组的常用操作" href="15159199909308.html">实战--数组的常用操作</a></li>
                        
                          <li><a title="SPL--SplObjectStorage 方法使用" href="15157440556671.html">SPL--SplObjectStorage 方法使用</a></li>
                        
                          <li><a title="文档--配置文件" href="15138234730339.html">文档--配置文件</a></li>
                        
                          <li><a title="文档--php 与 nginx" href="15128085452995.html">文档--php 与 nginx</a></li>
                        
                          <li><a title="文档--php7类型声明" href="15106716576449.html">文档--php7类型声明</a></li>
                        
                          <li><a title="文档--php7-use批量声明" href="15106714388264.html">文档--php7-use批量声明</a></li>
                        
                          <li><a title="实战--php7-新操作符<=>" href="15106713271560.html">实战--php7-新操作符<=></a></li>
                        
                          <li><a title="实战--php7-??" href="15106708822268.html">实战--php7-??</a></li>
                        
                          <li><a title="规范--php7-统一变量语法" href="15106705768192.html">规范--php7-统一变量语法</a></li>
                        
                          <li><a title="文档--php7-throwable" href="15106686521637.html">文档--php7-throwable</a></li>
                        
                          <li><a title="实战--练习题" href="15100534066184.html">实战--练习题</a></li>
                        
                          <li><a title="文档--基础" href="15100478594807.html">文档--基础</a></li>
                        
                          <li><a title="规范--开发" href="15096850612612.html">规范--开发</a></li>
                        

                    
                      <li class="side-title"><span>rabbitMq</span></li>
                        
                          <li><a title="rabbitMq使用（php）" href="15153208224566.html">rabbitMq使用（php）</a></li>
                        
                          <li><a title="RPC认识" href="15125232010346.html">RPC认识</a></li>
                        

                    
                      <li class="side-title"><span>raml的使用</span></li>
                        
                          <li><a title="实战--raml命令" href="15151387241047.html">实战--raml命令</a></li>
                        

                    
                      <li class="side-title"><span>linux</span></li>
                        
                          <li><a title="Linux下php-fpm进程过多导致内存耗尽问题解决" href="15171886819414.html">Linux下php-fpm进程过多导致内存耗尽问题解决</a></li>
                        
                          <li><a title="文档--常用命令" href="15157453713814.html">文档--常用命令</a></li>
                        
                          <li><a title="文档--nginx.conf" href="15121311525125.html">文档--nginx.conf</a></li>
                        
                          <li><a title="文档--资源使用情况-top" href="15118629061448.html">文档--资源使用情况-top</a></li>
                        
                          <li><a title="文档--资源使用情况-内存" href="15118570754250.html">文档--资源使用情况-内存</a></li>
                        
                          <li><a title="文档--资源使用情况-硬盘" href="15118542040577.html">文档--资源使用情况-硬盘</a></li>
                        
                          <li><a title="文档--系统定时任务-cron" href="15097607422303.html">文档--系统定时任务-cron</a></li>
                        
                          <li><a title="文档--服务重启" href="15097602933518.html">文档--服务重启</a></li>
                        
                          <li><a title="文档--系统定时任务-at" href="15097593737810.html">文档--系统定时任务-at</a></li>
                        
                          <li><a title="文档--linux 查看服务器系统的信息" href="15097189513675.html">文档--linux 查看服务器系统的信息</a></li>
                        
                          <li><a title="笔记--常用命令" href="15097187372089.html">笔记--常用命令</a></li>
                        

                    
                      <li class="side-title"><span>git</span></li>
                        
                          <li><a title="规范-提交代码规范" href="15097964202481.html">规范-提交代码规范</a></li>
                        
                          <li><a title="文档-git命令大全(图)" href="15097175223406.html">文档-git命令大全(图)</a></li>
                        
                          <li><a title="笔记-git 常用命令" href="15097169426182.html">笔记-git 常用命令</a></li>
                        

                    
                      <li class="side-title"><span>算法</span></li>
                        
                          <li><a title="文档--排序-说明" href="15098667005910.html">文档--排序-说明</a></li>
                        
                          <li><a title="文档--排序-归并排序" href="15098651418800.html">文档--排序-归并排序</a></li>
                        
                          <li><a title="文档--排序-插入排序-希尔排序（面试热点）" href="15097185400207.html">文档--排序-插入排序-希尔排序（面试热点）</a></li>
                        
                          <li><a title="文档--排序-选择排序" href="15097183591874.html">文档--排序-选择排序</a></li>
                        
                          <li><a title="文档--排序-插入排序-直接插入排序（面试热点）" href="15097183328300.html">文档--排序-插入排序-直接插入排序（面试热点）</a></li>
                        
                          <li><a title="文档--排序-快速排序（面试热点）" href="15097181541647.html">文档--排序-快速排序（面试热点）</a></li>
                        
                          <li><a title="文档--排序-冒泡(基础)" href="15097179853305.html">文档--排序-冒泡(基础)</a></li>
                        

                    
                      <li class="side-title"><span>数据结构</span></li>
                        
                          <li><a title="笔记--数据结构" href="15106207591946.html">笔记--数据结构</a></li>
                        
                          <li><a title="笔记--树-AVL" href="15105532782166.html">笔记--树-AVL</a></li>
                        
                          <li><a title="笔记--树-哈夫曼树" href="15105529119460.html">笔记--树-哈夫曼树</a></li>
                        
                          <li><a title="笔记--树-红黑树（Red Black Tree）" href="15102209229230.html">笔记--树-红黑树（Red Black Tree）</a></li>
                        
                          <li><a title="笔记--树-二叉查找树（BST）" href="15102205459934.html">笔记--树-二叉查找树（BST）</a></li>
                        
                          <li><a title="笔记--hash" href="15098725685121.html">笔记--hash</a></li>
                        
                          <li><a title="笔记--树" href="15098688823158.html">笔记--树</a></li>
                        

                    
                      <li class="side-title"><span>vagrant</span></li>
                        
                          <li><a title="笔记--vagrant 入门" href="15107599286648.html">笔记--vagrant 入门</a></li>
                        

                    
                      <li class="side-title"><span>java</span></li>
                        
                          <li><a title="基础-StringBuffer StringBuilder" href="15162420570699.html">基础-StringBuffer StringBuilder</a></li>
                        
                          <li><a title="基础-常用命令" href="15162420178152.html">基础-常用命令</a></li>
                        

                    
                      <li class="side-title"><span>springboot-实战</span></li>
                        
                          <li><a title="实战--请求参数的校验" href="15153099746529.html">实战--请求参数的校验</a></li>
                        
                          <li><a title="实战--参数类的封装（用到的注解）" href="15153060497346.html">实战--参数类的封装（用到的注解）</a></li>
                        
                          <li><a title="实战--代码读取配置文件" href="15152498896435.html">实战--代码读取配置文件</a></li>
                        
                          <li><a title="实战--application.yml配置" href="15152489636520.html">实战--application.yml配置</a></li>
                        
                          <li><a title="实战--aop切面编程" href="15152275531791.html">实战--aop切面编程</a></li>
                        
                          <li><a title="实战--热部署（热加载）" href="15152265532298.html">实战--热部署（热加载）</a></li>
                        
                          <li><a title="实战--整合mybatis （分页）" href="15152264815650.html">实战--整合mybatis （分页）</a></li>
                        
                          <li><a title="实战--日志" href="15152256498572.html">实战--日志</a></li>
                        
                          <li><a title="实战--统一异常处理" href="15152246712798.html">实战--统一异常处理</a></li>
                        
                          <li><a title="实战--返回json" href="15152240940735.html">实战--返回json</a></li>
                        

                    
                      <li class="side-title"><span>mysql</span></li>
                        
                          <li><a title="收藏地址" href="15169610880093.html">收藏地址</a></li>
                        
                          <li><a title="3中锁表方式" href="15169451004852.html">3中锁表方式</a></li>
                        
                          <li><a title="死锁问题" href="15168789059247.html">死锁问题</a></li>
                        
                          <li><a title="手册（笔记）" href="15168781243544.html">手册（笔记）</a></li>
                        
                          <li><a title="分库分表 优缺点 使用场景" href="15167034037540.html">分库分表 优缺点 使用场景</a></li>
                        
                          <li><a title="事务隔离级别详解" href="15141075416071.html">事务隔离级别详解</a></li>
                        
                          <li><a title="musql 文件类型" href="15122943074840.html">musql 文件类型</a></li>
                        
                          <li><a title="聚簇索引和非聚簇索引" href="15122861132096.html">聚簇索引和非聚簇索引</a></li>
                        
                          <li><a title="undo（撤销） redo（重做）" href="15122837144953.html">undo（撤销） redo（重做）</a></li>
                        
                          <li><a title="体系结构" href="15122798667483.html">体系结构</a></li>
                        

                    
                      <li class="side-title"><span>docker</span></li>
                        
                          <li><a title="笔记--本地环境" href="15122247911731.html">笔记--本地环境</a></li>
                        
                          <li><a title="笔记--docker-lnmp" href="15109921864789.html">笔记--docker-lnmp</a></li>
                        
                          <li><a title="笔记--docker 常用命令" href="15109855218654.html">笔记--docker 常用命令</a></li>
                        

                    
                      <li class="side-title"><span>redis</span></li>
                        
                          <li><a title="笔记--配置" href="15120904003130.html">笔记--配置</a></li>
                        
                          <li><a title="使用经验" href="15119287261764.html">使用经验</a></li>
                        
                          <li><a title="笔记--支持类型" href="15099434695015.html">笔记--支持类型</a></li>
                        

                    
                      <li class="side-title"><span>负载均衡</span></li>
                        
                          <li><a title="笔记--负载均衡相关技术" href="15119209173837.html">笔记--负载均衡相关技术</a></li>
                        
                          <li><a title="笔记--Kubernetes" href="15118321078018.html">笔记--Kubernetes</a></li>
                        
                          <li><a title="笔记--常用开源软件负载均衡器有：Nginx、LVS、Haproxy。" href="15118307471214.html">笔记--常用开源软件负载均衡器有：Nginx、LVS、Haproxy。</a></li>
                        

                    
                      <li class="side-title"><span>敏捷开发</span></li>
                        
                          <li><a title="敏捷开发流程" href="15162577596576.html">敏捷开发流程</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 <div class="markdown-body">
<h1>undo（撤销） redo（重做）</h1>

<h3 id="toc_0">Undo Log</h3>

<p><strong>Undo Log 是为了实现事务的原子性，在MySQL数据库InnoDB存储引擎中，还用Undo Log来实现多版本并发控制</strong>(简称：MVCC)。<br/>
- 事务的原子性(Atomicity)<br/>
  事务中的所有操作，要么全部完成，要么不做任何操作，不能只做部分操作。如果在执行的过程中发生<br/>
  了错误，要回滚(Rollback)到事务开始前的状态，就像这个事务从来没有执行过。<br/>
- 原理<br/>
  Undo Log的原理很简单，为了满足事务的原子性，在操作任何数据之前，首先将数据备份到一个地方<br/>
  （这个存储数据备份的地方称为Undo Log）。然后进行数据的修改。如果出现了错误或者用户执行了<br/>
  ROLLBACK语句，系统可以利用Undo Log中的备份将数据恢复到事务开始之前的状态。<br/>
除了可以保证事务的原子性，Undo Log也可以用来辅助完成事务的持久化。<br/>
- 事务的持久性(Durability)<br/>
  事务一旦完成，该事务对数据库所做的所有修改都会持久的保存到数据库中。为了保证持久性，数据库<br/>
  系统会将修改后的数据完全的记录到持久的存储上。<br/>
- 用Undo Log实现原子性和持久化的事务的简化过程<br/>
  假设有A、B两个数据，值分别为1,2。<br/>
  A.事务开始.<br/>
  B.记录A=1到undo log.<br/>
  C.修改A=3.<br/>
  D.记录B=2到undo log.<br/>
  E.修改B=4.<br/>
  F.将undo log写到磁盘。<br/>
  G.将数据写到磁盘。<br/>
  H.事务提交</p>

<p>这里有一个隐含的前提条件：‘数据都是先读到内存中，然后修改内存中的数据，最后将数据写回磁盘’。<br/>
  之所以能同时保证原子性和持久化，是因为以下特点：<br/>
  A. 更新数据前记录Undo log。<br/>
  B. 为了保证持久性，必须将数据在事务提交前写到磁盘。只要事务成功提交，数据必然已经持久化。<br/>
  C. Undo log必须先于数据持久化到磁盘。如果在G,H之间系统崩溃，undo log是完整的，<br/>
     可以用来回滚事务。<br/>
  D. 如果在A-F之间系统崩溃,因为数据没有持久化到磁盘。所以磁盘上的数据还是保持在事务开始前的状态。</p>

<h3 id="toc_1">缺陷：</h3>

<p>每个事务提交前将数据和Undo Log写入磁盘，这样会导致<strong>大量的磁盘IO，因此性能很低。</strong><br/>
如果能够将数据缓存一段时间，就能减少IO提高性能。但是这样就会丧失事务的持久性。因此引入了另外一<br/>
种机制来实现持久化，即Redo Log.</p>

<h3 id="toc_2">redo</h3>

<ul>
<li><p>原理<br/>
和Undo Log相反，Redo Log记录的是新数据的备份。在事务提交前，只要将Redo Log持久化即可，<br/>
不需要将数据持久化。当系统崩溃时，虽然数据没有持久化，但是Redo Log已经持久化。系统可以根据<br/>
Redo Log的内容，将所有数据恢复到最新的状态。</p></li>
<li><p>Undo + Redo事务的简化过程<br/>
假设有A、B两个数据，值分别为1,2.<br/>
A.事务开始.<br/>
B.记录A=1到undo log.<br/>
C.修改A=3.<br/>
D.记录A=3到  redo log.<br/>
E.记录B=2到undo log.<br/>
F.修改B=4.<br/>
G.记录B=4到  redo log.<br/>
H.将redo log写入磁盘。<br/>
I.事务提交</p></li>
<li><p>Undo + Redo事务的特点<br/>
A. 为了保证持久性，必须在事务提交前将Redo Log持久化。<br/>
B. <strong>数据不需要在事务提交前写入磁盘，而是缓存在内存中。</strong><br/>
C. Redo Log 保证事务的<strong>持久性</strong>。<br/>
D. Undo Log 保证事务的<strong>原子性</strong>。 事物提交之后，就会清楚<br/>
E. 有一个隐含的特点，数据必须要晚于redo log写入持久存储。</p></li>
<li><p>IO性能</p>

<p>** Undo + Redo的设计主要考虑的是提升IO性能。虽说通过缓存数据，减少了写数据的IO **<br/>
但是却引入了新的IO，即写Redo Log的IO。如果Redo Log的IO性能不好，就不能起到提高性能的目的。<br/>
为了保证Redo Log能够有比较好的IO性能，InnoDB 的 Redo Log的设计有以下几个特点：</p>

<p>A. 尽量保持Redo Log存储在一段连续的空间上。因此在系统第一次启动时就会将日志文件的空间完全分配。以顺序追加的方式记录Redo Log,通过顺序IO来改善性能。</p>

<p>B. 批量写入日志。日志并不是直接写入文件，而是先写入redo log buffer.当需要将日志刷新到磁盘时<br/>
 (如事务提交),将许多日志一起写入磁盘.</p>

<p>C. 并发的事务共享Redo Log的存储空间，它们的Redo Log按语句的执行顺序，依次交替的记录在一起，<br/>
 以减少日志占用的空间。例如,Redo Log中的记录内容可能是这样的：<br/>
 记录1: <trx1, insert …><br/>
 记录2: <trx2, update …><br/>
 记录3: <trx1, delete …><br/>
 记录4: <trx3, update …><br/>
 记录5: <trx2, insert …><br/>
D. 因为C的原因,当一个事务将Redo Log写入磁盘时，也会将其他未提交的事务的日志写入磁盘。<br/>
E. Redo Log上只进行顺序追加的操作，当一个事务需要回滚时，它的Redo Log记录也不会从<br/>
 Redo Log中删除掉。</p></li>
</ul>

<h3 id="toc_3">恢复(Recovery)</h3>

<ul>
<li>恢复策略
前面说到未提交的事务和回滚了的事务也会记录Redo Log，因此在进行恢复时,这些事务要进行特殊的
的处理.有2中不同的恢复策略：
A. 进行恢复时，只重做已经提交了的事务。
B. 进行恢复时，重做所有事务包括未提交的事务和回滚了的事务。然后通过Undo Log回滚那些
 未提交的事务。</li>
<li>InnoDB存储引擎的恢复机制
MySQL数据库InnoDB存储引擎使用了B策略, InnoDB存储引擎中的恢复机制有几个特点：
A. 在重做Redo Log时，并不关心事务性。 恢复时，没有BEGIN，也没有COMMIT,ROLLBACK的行为。
 也不关心每个日志是哪个事务的。尽管事务ID等事务相关的内容会记入Redo Log，这些内容只是被当作
 要操作的数据的一部分。
B. 使用B策略就必须要将Undo Log持久化，而且必须要在写Redo Log之前将对应的Undo Log写入磁盘。
 Undo和Redo Log的这种关联，使得持久化变得复杂起来。为了降低复杂度，InnoDB将Undo Log看作
 数据，因此记录Undo Log的操作也会记录到redo log中。这样undo log就可以象数据一样缓存起来，
 而不用在redo log之前写入磁盘了。
 包含Undo Log操作的Redo Log，看起来是这样的：
 记录1: <trx1, Undo log insert <undo_insert …>&gt;
 记录2: <trx1, insert …>
 记录3: <trx2, Undo log insert <undo_update …>&gt;
 记录4: <trx2, update …>
 记录5: <trx3, Undo log insert <undo_delete …>&gt;
 记录6: <trx3, delete …>
C. 到这里，还有一个问题没有弄清楚。既然Redo没有事务性，那岂不是会重新执行被回滚了的事务？
 确实是这样。同时Innodb也会将事务回滚时的操作也记录到redo log中。回滚操作本质上也是
 对数据进行修改，因此回滚时对数据的操作也会记录到Redo Log中。
 一个回滚了的事务的Redo Log，看起来是这样的：
 记录1: <trx1, Undo log insert <undo_insert …>&gt;
 记录2: <trx1, insert A…>
 记录3: <trx1, Undo log insert <undo_update …>&gt;
 记录4: <trx1, update B…>
 记录5: <trx1, Undo log insert <undo_delete …>&gt;
 记录6: <trx1, delete C…>
 记录7: <trx1, insert C>
 记录8: <trx1, update B to old value>
 记录9: <trx1, delete A>
 一个被回滚了的事务在恢复时的操作就是先redo再undo，因此不会破坏数据的一致性.</li>
<li>InnoDB存储引擎中相关的函数
Redo: recv_recovery_from_checkpoint_start()
Undo: recv_recovery_rollback_active()
Undo Log的Redo Log: trx_undof_page_add_undo_rec_log()</li>
</ul>

<p>总结<br/>
redo和undo是两种不同的innodb事务实现机制，它们都需要用到ib_logfile日志文件；<br/>
redo：是先记录操作日志，虽然记录操作日志也是应用了缓存（innodb_log_buffer）但是它还是比数据更新之前更新redo日志到磁盘日志文件中，数据的更新会在后面的线程刷新操作过程中被更新，redo操作事务提交后只有日志被持久化数据暂时未被持久化。<br/>
undo:undo操作也使用了缓存，只是它在事务提交的时候会同时将数据和日志更新到磁盘，这步操作就是和redo的主要区别，并且该操作对磁盘IO的消耗非常大，所以undo操作保证了事务的原子性，事务一旦提交数据也被持久化了。</p>


</div>

<br /><br />
<hr />

<div class="row clearfix">
  <div class="large-6 columns">
	<div class="text-left" style="padding:15px 0px;">
		
	        <a href="15167559156487.html"  title="Previous Post: 专业术语">&laquo; 专业术语</a>
	    
	</div>
  </div>
  <div class="large-6 columns">
	<div class="text-right" style="padding:15px 0px;">
		
	        <a href="15153208224566.html" 
	        title="Next Post: rabbitMq使用（php）">rabbitMq使用（php） &raquo;</a>
	    
	</div>
  </div>
</div>

<div class="row">
<div style="padding:0px 0.93em;" class="share-comments">

</div>
</div>
<script type="text/javascript">
	$(function(){
		var currentURL = '15122837144953.html';
		$('#side-nav a').each(function(){
			if($(this).attr('href') == currentURL){
				$(this).parent().addClass('active');
			}
		});
	});
</script>  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    <script src="asset/chart/all-min.js"></script><script type="text/javascript">$(function(){    var mwebii=0;    var mwebChartEleId = 'mweb-chart-ele-';    $('pre>code').each(function(){        mwebii++;        var eleiid = mwebChartEleId+mwebii;        if($(this).hasClass('language-sequence')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = Diagram.parse($(this).text());            diagram.drawSVG(eleiid,{theme: 'simple'});        }else if($(this).hasClass('language-flow')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = flowchart.parse($(this).text());            diagram.drawSVG(eleiid);        }    });});</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

  </body>
</html>
